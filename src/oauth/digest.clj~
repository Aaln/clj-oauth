(ns oath.digest
  (:import (javax.crypto Mac)
           (javax.crypto.spec SecretKeySpec)))

(defn hmac 
  "Calculate HMAC signature for given data."
  [key data]
  (let [hmac-sha1 "HmacSHA1"
        signing-key (SecretKeySpec. (.getBytes key) hmac-sha1)
        mac (doto (Mac. hmac-sha1)
              (.init signing-key))]
    (base64-encode (.doFinal mac (.getBytes data)))))

